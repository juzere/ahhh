{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos</title>
    <link rel="stylesheet" href="{% static 'css/products.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script> 
</head>
<body>
    <nav class="navbar">
        
      <img src="{% static 'sonnen.png' %}" alt="Logotipo da Empresa" class="logo">
      <div class="nav-group">
        
        <button class="contact-btn">Contato</button>
        
        <div class="dropdown">
            <button class="dropbtn" id="products-btn">Produtos</button>
            <div class="dropdown-content" id="product-dropdown">
                 {% for produto in produtos %}
                    <a href="{% url 'detalhes_produto' produto_id=produto.id %}">{{ produto.nome }}</a>
                {% empty %}
                    <p>Nenhum produto cadastrado.</p>
                {% endfor %}
            </div>
          </div>

        <a href="{% url 'logout' %}" class="button-logout">Sair</a>
      </div>

      
      
    </nav>
    
    
    <div id="contact-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Entre em Contato</h2>
            <p>Email: contato@sonnen.com.br</p>
            <p></p>
            <h4>Blumenau, Santa Catarina</h4>
            <p>Telefone: +55 (47) 3053-1551 </p>
            <p> </p>
            <h4>Santa Maria, Rio Grande do Sul</h4>
            <p>Telefone:+55 (55) 3223-4858</p>
            <p>Endereço: BR-287, 5635 - Camobi</p>
        </div>
    </div>

    
    <section class="product-list">
        <div class="product-container">
            {% for produto in produtos %}
                <div class="product-item">
                    <img src="{{ produto.imagem }}" alt="{{ produto.nome }}" style="width: 400px;">
                    <h2>{{ produto.nome }}</h2>
                    <a href="{% url 'detalhes_produto' produto_id=produto.id %}" class="explore-btn">Detalhes ></a>
                </div>
            {% empty %}
                <p>Você ainda não possui produtos cadastrados.</p>
            {% endfor %}
        </div>
    </section>

    <div style="width: 600px; height: 400px;">
        <canvas id="windSpeedChart"></canvas>
    </div>

    <!-- Scripts -->
    <script src="{% static 'js/products.js' %}"></script>
    <script>
        
         var contactModal = document.getElementById('contact-modal');
        var contactButton = document.querySelector('.contact-btn');
        var closeButton = document.querySelector('.close');

        contactButton.onclick = function() {
            contactModal.style.display = 'block';
        }

        closeButton.onclick = function() {
            contactModal.style.display = 'none';
        }

       
        window.onclick = function(event) {
            if (event.target == contactModal) {
                contactModal.style.display = 'none';
            }
        }

       
        var productDropdown = document.getElementById('product-dropdown');
        var productsButton = document.getElementById('products-btn');

        productsButton.onclick = function() {
            productDropdown.style.display = productDropdown.style.display === 'block' ? 'none' : 'block';
        }

        
        window.onclick = function(event) {
            if (!event.target.matches('.dropbtn')) {
                var dropdowns = document.getElementsByClassName("dropdown-content");
                for (var i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.style.display === 'block') {
                        openDropdown.style.display = 'none';
                    }
                }
            }
            if (event.target == contactModal) {
                contactModal.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
    var datas = JSON.parse('{{ datas_json|safe }}');
    var velocidades = JSON.parse('{{ velocidades_json|safe }}');
   

    var ctx = document.getElementById('windSpeedChart').getContext('2d');
    var windSpeedChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: datas,
            datasets: [{
                label: 'Velocidade do Vento (m/s)',
                data: velocidades,
                backgroundColor: 'rgba(255, 255, 0, 1)',
                borderColor: 'rgba(0, 0, 0, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                x: {
                    ticks: {
                        maxRotation: 90, 
                        minRotation: 45, 
                        autoSkip: true, 
                        maxTicksLimit: 15, 
                        fontSize: 10 
                    }
                },
                y: {
                    
                    beginAtZero: true,
                    ticks: {
                        fontSize: 12 
                    }
                }
            },
            responsive: true, 
            maintainAspectRatio: false, 
            tooltips: {
                mode: 'index',
                intersect: false,
                callbacks: {
                    label: function(tooltipItem, data) {
                        var label = data.datasets[tooltipItem.datasetIndex].label || '';
                        if (label) {
                            label += ': ';
                        }
                        label += Math.round(tooltipItem.yLabel * 100) / 100;
                        return label;
                    }
                }
            }
        }
    });
});

    </script>
</body>
</html>